<app-layout>
  <div class="inversiones-container">
    <div class="panel-header">
      <div>
        <p class="eyebrow">Panel en vivo · Bitget</p>
        <h1>Inversiones</h1>
        <p class="subtitle">Tokens del panel actualizados en tiempo real vía WebSocket</p>
      </div>
      <div class="status-group">
        <mat-chip-set>
          <mat-chip [color]="connectionStatus === 'connected' ? 'primary' : 'warn'" selected>
            <mat-icon>{{ connectionStatus === 'connected' ? 'cloud_done' : (connectionStatus === 'connecting' ? 'sync' : 'cloud_off') }}</mat-icon>
            <span class="chip-text">
              {{ connectionStatus === 'connected' ? 'Conectado' : connectionStatus === 'connecting' ? 'Conectando' : 'Desconectado' }}
            </span>
          </mat-chip>
          <mat-chip [color]="binanceStatus === 'connected' ? 'primary' : 'warn'" selected>
            <mat-icon>{{ binanceStatus === 'connected' ? 'cloud_done' : (binanceStatus === 'connecting' ? 'sync' : 'cloud_off') }}</mat-icon>
            <span class="chip-text">
              {{ binanceStatus === 'connected' ? 'Binance · Conectado' : binanceStatus === 'connecting' ? 'Binance · Conectando' : 'Binance · Desconectado' }}
            </span>
          </mat-chip>
        </mat-chip-set>
      </div>
    </div>

    <div class="tokens-wrapper">
      <div class="tokens-section negative-section">
        <h3 class="section-title">En Baja</h3>
        <div class="cards-grid" #negativeCarousel>
          <mat-card class="token-card" *ngFor="let row of negativeTokens">
            <div class="token-header">
              <div class="token-icon">{{ row.display.split('/')[0].trim().substring(0, 3) }}</div>
              <div class="token-info">
                <div class="token-name">{{ row.display }}</div>
                <div class="token-id">{{ row.instId }} · {{ row.source === 'binance' ? 'Binance' : 'Bitget' }}</div>
              </div>
            </div>
            <div class="token-body">
              <div class="price">{{ formatNumber(row.last, 4) }}</div>
              <div class="change down">
                <mat-icon>trending_down</mat-icon>
                <span>{{ row.changePct !== undefined ? (row.changePct | number:'1.2-2') + '%' : '-' }}</span>
              </div>
            </div>
          </mat-card>
        </div>
      </div>

      <div class="tokens-section positive-section">
        <h3 class="section-title">En Alza</h3>
        <div class="cards-grid" #positiveCarousel>
          <mat-card class="token-card" *ngFor="let row of positiveTokens">
            <div class="token-header">
              <div class="token-icon">{{ row.display.split('/')[0].trim().substring(0, 3) }}</div>
              <div class="token-info">
                <div class="token-name">{{ row.display }}</div>
                <div class="token-id">{{ row.instId }} · {{ row.source === 'binance' ? 'Binance' : 'Bitget' }}</div>
              </div>
            </div>
            <div class="token-body">
              <div class="price">{{ formatNumber(row.last, 4) }}</div>
              <div class="change up">
                <mat-icon>trending_up</mat-icon>
                <span>{{ row.changePct !== undefined ? (row.changePct | number:'1.2-2') + '%' : '-' }}</span>
              </div>
            </div>
          </mat-card>
        </div>
      </div>
    </div>
  </div>
</app-layout>
